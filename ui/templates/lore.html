<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lore Journal - Hollow Host</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <style>
        .lore-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        .page-header h1 {
            margin: 0;
        }
        
        .lore-layout {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 1.5rem;
        }
        
        .lore-sidebar {
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
        }
        
        .lore-sidebar h3 {
            margin-top: 0;
            margin-bottom: 1rem;
            color: #2c3e50;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 0.5rem;
        }
        
        .lore-categories {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .lore-category {
            margin-bottom: 0.5rem;
        }
        
        .lore-category a {
            display: block;
            padding: 0.5rem;
            color: #333;
            text-decoration: none;
            border-radius: 3px;
            transition: background-color 0.2s;
        }
        
        .lore-category a:hover,
        .lore-category a.active {
            background-color: #f0f0f0;
        }
        
        .lore-category a.active {
            font-weight: bold;
            color: #3498db;
        }
        
        .lore-search {
            margin-bottom: 1.5rem;
        }
        
        .lore-search input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 3px;
        }
        
        .lore-content {
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
        }
        
        .lore-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1rem;
        }
        
        .lore-item {
            background-color: #f8f9fa;
            border-radius: 3px;
            padding: 1rem;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .lore-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        .lore-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.5rem;
        }
        
        .lore-item-title {
            margin: 0;
            font-size: 1.1rem;
            color: #2c3e50;
        }
        
        .lore-item-type {
            font-size: 0.8rem;
            color: #666;
            background-color: #e9ecef;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
        }
        
        .lore-item-description {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
            max-height: 3.6rem;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
        }
        
        .lore-item-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.3rem;
            margin-top: 0.5rem;
        }
        
        .lore-tag {
            font-size: 0.75rem;
            background-color: #e1f5fe;
            color: #0288d1;
            padding: 0.1rem 0.4rem;
            border-radius: 3px;
        }
        
        .lore-detail {
            display: none;
        }
        
        .lore-detail.active {
            display: block;
        }
        
        .lore-detail-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .lore-detail-title {
            margin: 0;
            color: #2c3e50;
        }
        
        .lore-detail-type {
            font-size: 0.9rem;
            color: #666;
            background-color: #e9ecef;
            padding: 0.3rem 0.6rem;
            border-radius: 3px;
        }
        
        .lore-detail-meta {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            color: #666;
        }
        
        .lore-detail-description {
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }
        
        .lore-detail-section {
            margin-bottom: 1.5rem;
        }
        
        .lore-detail-section h3 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 1px solid #eee;
            padding-bottom: 0.5rem;
        }
        
        .lore-detail-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .lore-detail-tag {
            font-size: 0.85rem;
            background-color: #e1f5fe;
            color: #0288d1;
            padding: 0.2rem 0.5rem;
            border-radius: 3px;
        }
        
        .lore-detail-relations {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        
        .lore-relation {
            font-size: 0.85rem;
            background-color: #f0f0f0;
            padding: 0.2rem 0.5rem;
            border-radius: 3px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .lore-relation:hover {
            background-color: #e0e0e0;
        }
        
        .lore-actions {
            display: flex;
            justify-content: flex-end;
            gap: 0.5rem;
            margin-top: 2rem;
        }
        
        .empty-state {
            text-align: center;
            padding: 3rem;
            background-color: #f8f9fa;
            border-radius: 5px;
        }
        
        .empty-state h2 {
            margin-top: 0;
            color: #666;
        }
        
        .empty-state p {
            color: #888;
            margin-bottom: 1.5rem;
        }
    </style>
</head>
<body>
    <div class="lore-container">
        <div class="page-header">
            <h1>Lore Journal</h1>
            <div class="action-buttons">
                <a href="/lore/create" class="button">Add Entry</a>
                <a href="/" class="button">Back to Home</a>
            </div>
        </div>
        
        <div class="lore-layout">
            <div class="lore-sidebar">
                <div class="lore-search">
                    <input type="text" id="lore-search" placeholder="Search lore...">
                </div>
                
                <h3>Categories</h3>
                <ul class="lore-categories">
                    <li class="lore-category">
                        <a href="#" class="active" data-category="all">All Entries</a>
                    </li>
                    <li class="lore-category">
                        <a href="#" data-category="faction">Factions</a>
                    </li>
                    <li class="lore-category">
                        <a href="#" data-category="npc">NPCs</a>
                    </li>
                    <li class="lore-category">
                        <a href="#" data-category="place">Places</a>
                    </li>
                    <li class="lore-category">
                        <a href="#" data-category="event">Events</a>
                    </li>
                    <li class="lore-category">
                        <a href="#" data-category="fact">Facts</a>
                    </li>
                    <li class="lore-category">
                        <a href="#" data-category="journal">Journal Entries</a>
                    </li>
                </ul>
                
                <h3>Tags</h3>
                <div class="lore-tags">
                    {% for tag in tags %}
                    <span class="lore-tag" data-tag="{{ tag }}">{{ tag }}</span>
                    {% endfor %}
                </div>
            </div>
            
            <div class="lore-content">
                {% if lore_elements %}
                <div class="lore-list">
                    {% for element in lore_elements %}
                    <div class="lore-item" data-id="{{ element.id }}" data-type="{{ element.lore_type }}">
                        <div class="lore-item-header">
                            <h3 class="lore-item-title">{{ element.name }}</h3>
                            <span class="lore-item-type">{{ element.lore_type }}</span>
                        </div>
                        <div class="lore-item-description">{{ element.description }}</div>
                        <div class="lore-item-tags">
                            {% for tag in element.tags %}
                            <span class="lore-tag">{{ tag }}</span>
                            {% endfor %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                
                {% for element in lore_elements %}
                <div class="lore-detail" id="lore-detail-{{ element.id }}">
                    <div class="lore-detail-header">
                        <h2 class="lore-detail-title">{{ element.name }}</h2>
                        <span class="lore-detail-type">{{ element.lore_type }}</span>
                    </div>
                    
                    <div class="lore-detail-meta">
                        <span>Discovered: {{ element.discovery_timestamp|default('Unknown') }}</span>
                    </div>
                    
                    <div class="lore-detail-description">{{ element.description }}</div>
                    
                    {% if element.lore_type == 'faction' %}
                    <div class="lore-detail-section">
                        <h3>Leadership & Members</h3>
                        <p><strong>Leader:</strong> {{ element.leader|default('Unknown') }}</p>
                        <p><strong>Members:</strong> {{ element.members|join(', ')|default('None known') }}</p>
                        <p><strong>Alignment:</strong> {{ element.alignment|default('Neutral') }}</p>
                    </div>
                    
                    <div class="lore-detail-section">
                        <h3>Goals & Territories</h3>
                        <p><strong>Goals:</strong></p>
                        <ul>
                            {% for goal in element.goals %}
                            <li>{{ goal }}</li>
                            {% else %}
                            <li>No known goals</li>
                            {% endfor %}
                        </ul>
                        <p><strong>Territories:</strong> {{ element.territories|join(', ')|default('None known') }}</p>
                    </div>
                    {% endif %}
                    
                    {% if element.lore_type == 'npc' %}
                    <div class="lore-detail-section">
                        <h3>Character Information</h3>
                        <p><strong>Faction:</strong> {{ element.faction_id|default('None') }}</p>
                        <p><strong>Location:</strong> {{ element.location_id|default('Unknown') }}</p>
                        <p><strong>Role:</strong> {{ element.role|default('Unknown') }}</p>
                        <p><strong>Status:</strong> {{ 'Alive' if element.is_alive else 'Deceased' }}</p>
                    </div>
                    
                    <div class="lore-detail-section">
                        <h3>Appearance & Personality</h3>
                        <p><strong>Appearance:</strong> {{ element.appearance|default('No description available') }}</p>
                        <p><strong>Personality Traits:</strong></p>
                        <ul>
                            {% for trait in element.personality %}
                            <li>{{ trait }}</li>
                            {% else %}
                            <li>No known traits</li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endif %}
                    
                    {% if element.lore_type == 'place' %}
                    <div class="lore-detail-section">
                        <h3>Location Information</h3>
                        <p><strong>Region:</strong> {{ element.region|default('Unknown') }}</p>
                        <p><strong>Controlling Faction:</strong> {{ element.controlling_faction|default('None') }}</p>
                        <p><strong>Visited:</strong> {{ 'Yes' if element.visited else 'No' }}</p>
                    </div>
                    
                    <div class="lore-detail-section">
                        <h3>Points of Interest</h3>
                        <ul>
                            {% for poi in element.points_of_interest %}
                            <li>{{ poi }}</li>
                            {% else %}
                            <li>No known points of interest</li>
                            {% endfor %}
                        </ul>
                    </div>
                    
                    <div class="lore-detail-section">
                        <h3>Dangers & Resources</h3>
                        <p><strong>Dangers:</strong></p>
                        <ul>
                            {% for danger in element.dangers %}
                            <li>{{ danger }}</li>
                            {% else %}
                            <li>No known dangers</li>
                            {% endfor %}
                        </ul>
                        <p><strong>Resources:</strong></p>
                        <ul>
                            {% for resource in element.resources %}
                            <li>{{ resource }}</li>
                            {% else %}
                            <li>No known resources</li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endif %}
                    
                    {% if element.lore_type == 'event' %}
                    <div class="lore-detail-section">
                        <h3>Event Information</h3>
                        <p><strong>Date:</strong> {{ element.date|default('Unknown') }}</p>
                        <p><strong>Locations:</strong> {{ element.location_ids|join(', ')|default('Unknown') }}</p>
                        <p><strong>Player Involved:</strong> {{ 'Yes' if element.player_involved else 'No' }}</p>
                    </div>
                    
                    <div class="lore-detail-section">
                        <h3>Participants & Consequences</h3>
                        <p><strong>Participants:</strong></p>
                        <ul>
                            {% for participant in element.participants %}
                            <li>{{ participant }}</li>
                            {% else %}
                            <li>No known participants</li>
                            {% endfor %}
                        </ul>
                        <p><strong>Consequences:</strong></p>
                        <ul>
                            {% for consequence in element.consequences %}
                            <li>{{ consequence }}</li>
                            {% else %}
                            <li>No known consequences</li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endif %}
                    
                    {% if element.lore_type == 'fact' %}
                    <div class="lore-detail-section">
                        <h3>Fact Information</h3>
                        <p><strong>Source:</strong> {{ element.source|default('Unknown') }}</p>
                        <p><strong>Confidence:</strong> {{ element.confidence }}%</p>
                        <p><strong>Truth Value:</strong> {{ 'True' if element.truth_value else 'False' }}</p>
                    </div>
                    {% endif %}
                    
                    {% if element.lore_type == 'journal' %}
                    <div class="lore-detail-section">
                        <h3>Journal Entry</h3>
                        <p><strong>Date:</strong> {{ element.entry_date|default('Unknown') }}</p>
                        <p><strong>Location:</strong> {{ element.location_id|default('Unknown') }}</p>
                        <p><strong>Session:</strong> {{ element.session_id|default('Unknown') }}</p>
                    </div>
                    
                    <div class="lore-detail-section">
                        <h3>Narrative</h3>
                        <div class="journal-narrative">{{ element.narrative_text }}</div>
                    </div>
                    
                    <div class="lore-detail-section">
                        <h3>Player Notes</h3>
                        <div class="journal-notes">{{ element.player_notes }}</div>
                    </div>
                    {% endif %}
                    
                    <div class="lore-detail-section">
                        <h3>Related Elements</h3>
                        <div class="lore-detail-relations">
                            {% for related in element.related_elements %}
                            <span class="lore-relation" data-id="{{ related }}">{{ related }}</span>
                            {% else %}
                            <p>No related elements</p>
                            {% endfor %}
                        </div>
                    </div>
                    
                    <div class="lore-detail-tags">
                        {% for tag in element.tags %}
                        <span class="lore-detail-tag">{{ tag }}</span>
                        {% endfor %}
                    </div>
                    
                    <div class="lore-actions">
                        <a href="/lore/edit/{{ element.id }}" class="button">Edit</a>
                        <button class="button button-secondary lore-back-button">Back to List</button>
                    </div>
                </div>
                {% endfor %}
                
                {% else %}
                <div class="empty-state">
                    <h2>No Lore Entries Found</h2>
                    <p>Your lore journal is empty. Start adding entries to build your world's history and knowledge.</p>
                    <a href="/lore/create" class="button">Add First Entry</a>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Lore item click handler
            const loreItems = document.querySelectorAll('.lore-item');
            const loreList = document.querySelector('.lore-list');
            const loreDetails = document.querySelectorAll('.lore-detail');
            const backButtons = document.querySelectorAll('.lore-back-button');
            
            loreItems.forEach(item => {
                item.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    loreList.style.display = 'none';
                    
                    loreDetails.forEach(detail => {
                        detail.classList.remove('active');
                    });
                    
                    document.getElementById(`lore-detail-${id}`).classList.add('active');
                });
            });
            
            backButtons.forEach(button => {
                button.addEventListener('click', function() {
                    loreDetails.forEach(detail => {
                        detail.classList.remove('active');
                    });
                    loreList.style.display = 'grid';
                });
            });
            
            // Category filter
            const categoryLinks = document.querySelectorAll('.lore-category a');
            
            categoryLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    categoryLinks.forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                    
                    const category = this.getAttribute('data-category');
                    
                    loreItems.forEach(item => {
                        if (category === 'all' || item.getAttribute('data-type') === category) {
                            item.style.display = 'block';
                        } else {
                            item.style.display = 'none';
                        }
                    });
                });
            });
            
            // Search functionality
            const searchInput = document.getElementById('lore-search');
            
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                
                loreItems.forEach(item => {
                    const title = item.querySelector('.lore-item-title').textContent.toLowerCase();
                    const description = item.querySelector('.lore-item-description').textContent.toLowerCase();
                    
                    if (title.includes(searchTerm) || description.includes(searchTerm)) {
                        item.style.display = 'block';
                    } else {
                        item.style.display = 'none';
                    }
                });
            });
        });
    </script>
</body>
</html>